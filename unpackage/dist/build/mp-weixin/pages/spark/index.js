(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/spark/index"],{"309d":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;t("81e1"),t("34be");var o=function(){t.e("components/wyb-popup/wyb-popup").then(function(){return resolve(t("2ef6"))}.bind(null,t)).catch(t.oe)},a=function(){t.e("components/pzy-tabs/pzy-tabs").then(function(){return resolve(t("135d"))}.bind(null,t)).catch(t.oe)},r=function(){Promise.all([t.e("common/vendor"),t.e("pages/spark/spark-deals")]).then(function(){return resolve(t("f1e6"))}.bind(null,t)).catch(t.oe)},s=function(){Promise.all([t.e("common/vendor"),t.e("pages/spark/spark-entrust")]).then(function(){return resolve(t("871e"))}.bind(null,t)).catch(t.oe)},u=function(){Promise.all([t.e("common/vendor"),t.e("pages/spark/spark-buy")]).then(function(){return resolve(t("a87d"))}.bind(null,t)).catch(t.oe)},c=function(){Promise.all([t.e("common/vendor"),t.e("pages/spark/spark-sell")]).then(function(){return resolve(t("75a2"))}.bind(null,t)).catch(t.oe)},l=function(){Promise.all([t.e("common/vendor"),t.e("pages/spark/spark-data")]).then(function(){return resolve(t("650e"))}.bind(null,t)).catch(t.oe)},i={name:"spark",components:{liuyunoTabs:a,sparkDeals:r,sparkEntrust:s,sparkBuy:u,sparkSell:c,sparkData:l,wybPopup:o},data:function(){return{timer:null,sliderTop:40,tabs:["数据","买入","卖出","委托","成交"],areaList:[],defaultIndex:0,flag:!1,slider_tabs:[{text:"FNT/GS",num:"32.55"},{text:"FNT/GS",num:"32.55"},{text:"FNT/GS",num:"32.55"}],sliderIndex:1}},onLoad:function(){var n=this;e.getSystemInfo({success:function(e){var t=e.statusBarHeight+45;n.sliderTop=t}});this.createSocket()},onUnload:function(){clearInterval(this.timer)},onShow:function(){},onHide:function(){clearInterval(this.timer)},methods:{openPopud:function(){this.$refs.popup.show()},tabClick:function(e){this.defaultIndex=e},changeSliderIndex:function(e){this.sliderIndex=e},createSocket:function(){var n=this;console.log(e.getStorageSync("token"));var t=e.connectSocket({url:"ws://211.149.135.240:7888/websocket/trade",header:{token:e.getStorageSync("token")},success:function(e){console.log("开始发送")},fail:function(e){console.log("链接失败"+e)}});t.onOpen((function(e){n.handlerHeartbeat(),n.getGSList(),n.flag=!0})),e.onSocketError((function(e){console.log(e),console.log("WebSocket连接打开失败，请检查！")})),e.onSocketMessage((function(e){var t=JSON.parse(e.data);console.log("👇👇👇👇👇👇👇👇👇"),console.log(t);var o=t.obj;switch(t.code){case-1:n.$refs.uToast.show({message:t.obj,type:"error"});break;case 0:n.areaList=o;break;case 9:1===n.defaultIndex?n.$refs["buy"].setBuyList(o):3===n.defaultIndex?n.$refs["entrust"].setBuyList(o):2===n.defaultIndex&&n.$refs["sell"].setBuyList(o);break;case 8:1!==n.defaultIndex&&2!==n.defaultIndex||n.$refs[1===n.defaultIndex?"buy":"sell"].getEntrustList(o);break;case 10:if(1===n.defaultIndex||2===n.defaultIndex)return void n.$refs[1===n.defaultIndex?"buy":"sell"].setWallet(o);3===n.defaultIndex&&n.$refs["entrust"].setWallet(o);break;case 11:n.$refs["data"]&&n.$refs["data"].handleKLine(o);break;case 12:console.log("交易记录"),console.log(o);break;case 13:n.$refs["data"]&&n.$refs["data"].setMarket(o),(n.$refs["buy"]||n.$refs["sell"])&&n.$refs[1===n.defaultIndex?"buy":"sell"].setBuyList(o);break}}))},sendSocket:function(n){n.token=e.getStorageSync("token"),e.sendSocketMessage({data:"string"===typeof n?n:JSON.stringify(n),success:function(e){},fail:function(e){}})},getGSList:function(){this.sendSocket({method:"getAreaTrade"})},handlerEntrust:function(e){var n=e.data;this.sendSocket(n)},handlerData:function(e){var n=e.data;this.sendSocket(n)},handlerHeartbeat:function(){var n=this;this.timer=setInterval((function(){e.getStorageSync("token")?n.sendSocket({from:164603442e4,to:164604228e4,resolution:"1",tradeId:9,method:"kData"}):(clearInterval(n.timer),e.closeSocket(),e.redirectTo({url:"/pages/login/index"}))}),5e3)}}};n.default=i}).call(this,t("543d")["default"])},"44c4":function(e,n,t){"use strict";t.r(n);var o=t("309d"),a=t.n(o);for(var r in o)"default"!==r&&function(e){t.d(n,e,(function(){return o[e]}))}(r);n["default"]=a.a},5462:function(e,n,t){"use strict";var o=t("e1be"),a=t.n(o);a.a},"76be":function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return o}));var o={uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"be06"))},wybPopup:function(){return t.e("components/wyb-popup/wyb-popup").then(t.bind(null,"2ef6"))},uToast:function(){return t.e("node-modules/uview-ui/components/u-toast/u-toast").then(t.bind(null,"0562"))}},a=function(){var e=this,n=e.$createElement;e._self._c},r=[]},bebe:function(e,n,t){"use strict";(function(e){t("cb10");o(t("66fd"));var n=o(t("ca78"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=t,e(n.default)}).call(this,t("543d")["createPage"])},ca78:function(e,n,t){"use strict";t.r(n);var o=t("76be"),a=t("44c4");for(var r in a)"default"!==r&&function(e){t.d(n,e,(function(){return a[e]}))}(r);t("5462");var s,u=t("f0c5"),c=Object(u["a"])(a["default"],o["b"],o["c"],!1,null,"4391464c",null,!1,o["a"],s);n["default"]=c.exports},e1be:function(e,n,t){}},[["bebe","common/runtime","common/vendor"]]]);